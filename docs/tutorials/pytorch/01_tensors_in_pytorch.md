# 01. Tensors in PyTorch

## Что такое тензор в PyTorch

Тензор — это фундаментальная структура данных в PyTorch, представляющая собой многомерный массив, содержащий элементы одного типа данных. Тензоры являются обобщением векторов и матриц на произвольное число измерений. Если вы знакомы с NumPy, то будьте счастливы, ведь тензоры PyTorch очень похожи на ndarrays в NumPy, но с ключевыми отличиями: 
	1. **Поддержка ускорителей**: Тензоры могут работать на графических процессорах (GPU) и других аппаратных ускорителях, что критически важно для массивно-параллельных вычислений в глубоком обучении.
	2. **Автоматическое дифференцирование**: Тензоры оптимизированы для автоматического вычисления градиентов, что является основой алгоритма обратного распространения ошибки для обучения нейронных сетей.
**Использование в контексте ML**: Тензоры служат для кодирования входных и выходных данных модели, а также параметров самой модели.

## Основные операции:

- Создание тензоров (`torch.tensor()`, `torch.from_numpy()`, `etc.`)
- Арифметические операции (`torch.add()`, `torch.mul()`, `etc.`)
- **Broadcasting** — это механизм, который позволяет PyTorch автоматически расширять размерности тензоров для совместимости при выполнении операций.
- **Concatenate**(`.cat()`) — это функция, которая позволяет объединить тензоры по заданноfму, уже существующему измерению.
- **Stack**(`.stack()`) — это функция, которая позволяет объединить тензоры, создав новое измерение.

## CPU vs GPU (device):

Одна из ключевых особенностей PyTorch заключается именно в работе с различными вычислительными устройствами. 
- По умолчанию тензоры создаются на CPU (можно изменить на конкретное устройство).
- Проверка доступности по команде (`.is_available()`)
- Перенос доступен по команде (`.to(<device>)`
- Все тензоры в операции должны быть на одном устройстве
- Модели нужно переносить вместе с тензорами
- Новые тензоры, созданные внутри модели, не автоматически попадают на GPU.

## Типы данных:

**Типы с плавающей точкой**:​
- `torch.float32` (или `torch.float`): 32-бит, наиболее распространенный, используется по умолчанию​
- `torch.float64` (или `torch.double`): 64-бит, большая точность, но вдвое больше памяти
- `torch.float16` (или `torch.half`): 16-бит, экономит память, ускоряет вычисления на современных GPU
- `torch.bfloat16`: 16-бит, диапазон как у float32, но меньше точность, используется в mixed-precision обучении
**Целочисленные типы**:​
- `torch.int64` (или `torch.long`): 64-бит, по умолчанию для целых чисел
- `torch.int32` (или `torch.int`): 32-бит целые
- `torch.int16` (или `torch.short`): 16-бит целые
- `torch.int8`: 8-бит целые
- `torch.uint8`: 8-бит беззнаковые целые
**Другие типы**:
- `torch.bool`: булевы значения
- `torch.complex64`, `torch.complex128`: комплексные числа

*Примечание: torch.int64 и torch.long являются идентичными сущностями, это просто разные названия одного и того же объекта, так же и с другими типами данных.*

## Вопросы для самоконтроля:

1. Что такое тензор в PyTorch?
2. Ключевые отличие Тензора от NumPy array?
3. Какие операции определены над Тензорами?
4. Работу с какими вычислительными устройствами поддерживает PyTorch?
5. На каком устройстве по умолчанию создаются тензоры и как 
6. Как перенести тензор между устройствами?
7. Какие типы данных поддерживает Тензоры?
8. Чем отличаются `torch.int64` и `torch.long`?
